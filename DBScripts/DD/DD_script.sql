DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'LoanManagementSystem.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201508021207373_Initialcreate'
BEGIN
    CREATE TABLE [dbo].[Users] (
        [UserID] [int] NOT NULL IDENTITY,
        [Code] [nvarchar](10),
        [Name] [nvarchar](50),
        [Description] [nvarchar](max),
        [UserGroupID] [bigint] NOT NULL,
        [IsActive] [bit] NOT NULL,
        CONSTRAINT [PK_dbo.Users] PRIMARY KEY ([UserID])
    )
    CREATE INDEX [IX_UserGroupID] ON [dbo].[Users]([UserGroupID])
    CREATE TABLE [dbo].[UserGroup] (
        [UserGroupId] [bigint] NOT NULL IDENTITY,
        [Name] [nvarchar](100),
        [Code] [nvarchar](10),
        [Status] [int] NOT NULL,
        [IsDeleted] [bit] NOT NULL,
        [Description] [nvarchar](max),
        [CreatedOn] [datetime] NOT NULL,
        [CreatedBy] [bigint] NOT NULL,
        [ModifiedOn] [datetime] NOT NULL,
        [ModifiedBy] [bigint] NOT NULL,
        CONSTRAINT [PK_dbo.UserGroup] PRIMARY KEY ([UserGroupId])
    )
    ALTER TABLE [dbo].[Users] ADD CONSTRAINT [FK_dbo.Users_dbo.UserGroup_UserGroupID] FOREIGN KEY ([UserGroupID]) REFERENCES [dbo].[UserGroup] ([UserGroupId]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201508021207373_Initialcreate', N'LoanManagementSystem.Migrations.Configuration',  0x1F8B0800000000000400D55ADB6EE336107D2FD07F10F4D416D9C8CE768B36B07791381718DDC48B38BBE8DB829668852845AA2415D828FA657DE827F5173AD4951225DB8A9DCD16018298E41C0E87678633E3FCFBF73FA377AB883A8F5848C2D9D81D1E0F5C07339F078485633751CB573FBBEFDE7EFBCDE8328856CEA762DD6BBD0E24991CBB0F4AC5A79E27FD071C21791C115F70C997EAD8E7918702EE9D0C06BF78C3A18701C2052CC719DD254C9108A71FE0E384331FC72A41F4860798CA7C1C66E629AA738B222C63E4E3B1FB9E237683180A7184999AAFA5C2D17126E63A67942050698EE9D27510635C21050A9F7E9478AE0467E13C860144EFD73186754B4425CE0F725A2DDFF54C83137D26AF122CA0FC442A1EF5041CBECE8DE435C59F646AB7342298F112CCADD6FAD4A929C7AE0C1407A308D7696E763AA1422FDC68E9E342FEC8B9400AE5A34725418047FAE7C899245425028F194E9440F4C8F9902C28F17FC5EB7BFE3B666396506A6A0ABAC25C6D00863E081E63A1D6777899EBAFF79E5EB88E5797F59AC2A568432E3BE194A9D727AE730B4AA005C525210C6BCC1517F81A332C90C2C107A41416709FD300A726B53468EC3701C314BB0103C1AB5CE706ADDE6316AA07F03770A32BB2C24131902BF09111F041905122C1DBF6D0BF37ECF1E6107B5C60E90B12676CECDC0AFE3CC05EFA8EAE054FE2DA45FDF463CB456D069ACA335F91C7D238E79C538CD8769C5BF448C2F4FEBB54739D3B4CD315F281C459C4299DE2B3B1EC4AF0E88E53C3E5AAD9CF739E085FABC73B97DC23116255D770E455FEBC9397E7BAECE7EA29C84BFA7BC689E0694E5F0A6F26D4E13C7F8B570E078770CB2F115EE6608F4496BB68A297062DE67A3BE605A618ACDADB335F302C4D04D64498953B8127E07BA26FB9A7D639D2F97ABFF0064E4896E4201A1550FD54EA8E43496444218B2D5379455158E55FDD71C90836C71A55FBA28EB94D061E242C011D022CE81AE863A60775C3DDE0688145C16386F207E613A2090C0C2C43D7D69FD5570F6D7366863307CFA4E43E498FDD88EAC63353DFF39205CEF637A772E72A19BC013B91182C03B73A767FB04EB311B978AA5A90F307A80E3F749B717FC6B2B8E06843E9B47982A48F029BBE60A9A03E024F05163A32230AD584845B264CD9EF0A613E8911DD7A888664DF3749AB586ED69CB9C03166FA15D97A49FDB4B0D261AD45B959C380DBEC35F20CE2D94906C828902899AD13888B733D8A57AAC5A341CBDCA9651E6D9BC4D2A873AC8C53B94E155E2CA65AC4B4E5C38C749D2039291B48C6B12BB8B6CCCE58D89DFF35EF6327D72C0F53D8C1BAD69DFCB00113B61ED7AB9FB725BA97575D55E55E569617E5BBD751BF8F6E501C433435EAF97CC49967C5FCE4D5BC7F711B65189E2F5B6ADC52DB722748E320AF6DCC66A9D3151152E9976381F43B3409226B599DD81DA42BF632B86BDF58C1C262B1FEBB729E6DD9774B2CC881AEE0785A2E3D29362EBD5B346DAC208A4447753CE13489D8A64A7B134A96949A18D9C8EE0859EE6C226423BB23D4124313A836B13B5E2DCA36CDD3197EBBF1AAD2D404AB466DA491D7B86F2BD45B14B3DECC3A5D772673D811CAF663746B80EC41EB0EF9ED371874DD60CB33DE8DB73F47F7F79322A136318AB13E5C2CABB13A19CBE197F33BA3E8AA19AA1AEE8DA56B9C16AC73ABA2DF8465D65E269839DE1FADA99A39FE852382F5FA379794BB975940E3B51FE52FEFF696BEF514674B5C07CCF44802FD0CE72124ADF2E67FD0092570DE6A01C41AB2C45265D59C7B32189E34BE0CF87A1AF39E9401DDB13BFF629D71A2ADBBB503D6B7EF6174ABD82312FE031256BFAAC2ECDBFB6E857CD31BB2A5A754207F17A1D5F77DF15ADAD90B12A606B6CAA429946AABB1FB672A7AEA4C7FFB6C481F3933015C3F7506CE5F7BF7C217443DB9BBB3B1CBFC1534770BF31E9ABF5BC9963675FBB1E3197CA2DEB04D2DB16F7F763B5B9EDF8FACFE6B001FD541FAAF0561F66EC03E5925BB01BB934E5D3E7A90A661DEE77891769EADCD133B967BF505BB4A94E7EF05FE8F5A7F762365736BAEBABB0DEDBD2C0304875A70B8F88CFF7AC62A6C3AE1AF77EBFE756DF47534076B8768A97E77E90CB68A3F4F1FD0CEF8816DC6BFFA00DD25092B08FD8F3F0CFB359E956BA66CC90BCE37342A96348328560822303A138A2C91AF60DAC752A65F07E65FB95C460B1C4CD92C5171A2E0C8385AD05A71A5DD66D3FE69B3B3AEF368963E72F210470035897E4466EC3C213428F5BE6A89FD1D10DA1FF3A447DFA5D2C94FB82E916E39DB1128375F1946EE7114530093333647C6D7583D7403EABDC721F2D745E1D60DB2FD22EA661F5D10140A14C91CA392878FC0E1205ABDFD0FE83ADD07F1260000 , N'6.1.1-30610')
END

